<?xml version="1.0" encoding="utf-8" ?>
<ContentView x:Class="MauiPerfDebugOverlay.Controls.PerformanceOverlayView"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:MauiPerfDebugOverlay.InternalControls"
             x:Name="Root"
             IsVisible="True"
             Opacity="1">

    <Frame x:Name="OverlayFrame"
           BackgroundColor="#CC000000"
           Padding="8"
           CornerRadius="10"
           HasShadow="True">

        <Frame.GestureRecognizers>
            <PanGestureRecognizer PanUpdated="OnPanUpdated" />
            <TapGestureRecognizer Tapped="OnToggleCompactTapped" />
        </Frame.GestureRecognizers>

        <VerticalStackLayout>

            <ScrollView Orientation="Horizontal">
                <HorizontalStackLayout x:Name="HeaderStack">
                    <!-- Tab 1: General Metrics -->
                    <Button x:Name="BtnTabGeneral"
                            Text="ðŸ“Š"
                            BackgroundColor="Gray"
                            Padding="0"
                            Margin="0"
                            CommandParameter="TabGeneral"
                            Clicked="OnTabClicked" />

                    <!-- Tab 2: Diagnostics Metrics -->
                    <Button x:Name="BtnTabScroll"
                            Text="ðŸ“¡"
                            BackgroundColor="Gray"
                            Padding="0"
                            Margin="4,0"
                            CommandParameter="TabDiagnostics"
                            Clicked="OnTabClicked" />

                    <!-- Tab 3: Network Metrics -->
                    <Button x:Name="BtnTabNetwork"
                            Text="ðŸŒ"
                            BackgroundColor="Gray"
                            Padding="0"
                            Margin="0,0,4,0"
                            CommandParameter="TabNetwork"
                            Clicked="OnTabClicked" />

                    <!-- Tab 4: Tree Init Time -->
                    <Button x:Name="BtnTabTree"
                            Text="ðŸŒ³"
                            BackgroundColor="Gray"
                            Padding="0"
                            Margin="0"
                            CommandParameter="TabTree"
                            Clicked="OnTabClicked" />
                </HorizontalStackLayout>
            </ScrollView>

            <BoxView HeightRequest="1"
                     Color="Gray"
                     Margin="0,4" />

            <Label x:Name="NewVersionLabel"
                   FontAttributes="Bold"
                   FontSize="12"
                   TextColor="Red"
                   IsVisible="False"
                   Text="" />

            <VerticalStackLayout x:Name="MetricsStack"
                                 Spacing="2"
                                 Margin="0,0,0,0">


                <Label x:Name="FpsLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="FPS: --" />

                <Label x:Name="FrameTimeLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="FrameTime: -- ms" />

                <Label x:Name="HitchLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="Last Hitch: none" />

                <Label x:Name="HighestHitchLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="Highest Hitch: none" />

                <BoxView HeightRequest="1"
                         x:Name="BoxViewCpu"
                         Color="Gray"
                         Margin="0,4" />

                <Label x:Name="CpuLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="CPU: --%" />

                <Label x:Name="ThreadsLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="Threads: --" />

                <BoxView HeightRequest="1"
                         x:Name="BoxViewMemory_GC"
                         Color="Gray"
                         Margin="0,4" />

                <Label x:Name="MemoryLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="Memory: -- MB" />

                <Label x:Name="GcLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="GC: --" />

                <Label x:Name="AllocLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="Alloc/sec: -- MB" />

                <BoxView HeightRequest="1"
                         x:Name="BoxViewBattery"
                         Color="Gray"
                         Margin="0,4" />

                <Label x:Name="BatteryLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="Hitch: none" />

                <BoxView HeightRequest="1"
                         x:Name="BoxViewNetwork"
                         Color="Gray"
                         Margin="0,4" />

                <Label x:Name="NetworkLabel"
                       FontAttributes="Bold"
                       FontSize="12"
                       TextColor="Gray"
                       Text="Network:" />

            </VerticalStackLayout>

            <controls:DiagnosticsMetricsView BackgroundColor="Transparent"
                                             IsVisible="False"
                                             HeightRequest="100"
                                             x:Name="DiagnosticsMetrics" />

            <controls:DiagnosticsNetworkView BackgroundColor="Transparent"
                                             IsVisible="False"
                                             HeightRequest="100"
                                             x:Name="DiagnosticsNetwork" />

            <controls:TreeViewControl BackgroundColor="Transparent"
                                      IsVisible="False"
                                      HeightRequest="300"
                                      WidthRequest="300"
                                      x:Name="TheTreeView" />

        </VerticalStackLayout>
    </Frame>
</ContentView>
